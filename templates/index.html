<!DOCTYPE html>
<html>
<head>
    <title>Motor Control</title>
    <style>
        #joystick {
            width: 200px;
            height: 200px;
            position: relative;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nipplejs/0.8.7/nipplejs.min.js"></script>
</head>
<body>
    <h1>Motor Control</h1>
    <div>
        <label for="motor">Motor:</label>
        <select id="motor">
            <option value="A">Motor A</option>
            <option value="B">Motor B</option>
        </select>
    </div>
    <div>
        <label for="speed">Speed (0-100):</label>
        <input type="range" id="speed" name="speed" min="0" max="100" value="50">
    </div>
    <div id="joystick"></div>

    <script>
        function controlMotor(action, speed) {
            const motor = document.getElementById('motor').value;

            fetch('/control', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `motor=${motor}&action=${action}&speed=${speed}`
            });
        }

        const joystick = nipplejs.create({
            zone: document.getElementById('joystick'),
            mode: 'static',
            position: { left: '50%', top: '50%' },
            color: 'blue'
        });

        joystick.on('move', (evt, data) => {
            const speed = document.getElementById('speed').value;
            if (data.direction) {
                const direction = data.direction.angle;
                if (direction === 'up') {
                    controlMotor('forward', speed);
                } else if (direction === 'down') {
                    controlMotor('backward', speed);
                } else if (direction === 'left') {
                    controlMotor('left', speed);
                } else if (direction === 'right') {
                    controlMotor('right', speed);
                }
            }
        });

        joystick.on('end', () => {
            controlMotor('stop', 0);
        });
    </script>
</body>
</html>